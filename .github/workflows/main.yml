import time

from locust import task, User

import app

 

class ComputeUser(User):

 

    @task

    def test_compute_fib_value(self):

        start = time.time()

 

        try:

            result = app.compute_fib_value()

 

            total_ms = (time.time() - start) * 1000

            self.environment.runner.stats.log_request(

                "function",

                "compute_fib_value",

                total_ms,

                0

            )

 

        except Exception as e:

            total_time = (time.time() - start) * 1000

            self.environment.runner.stats.log_error(

                "function",

                "compute_fib_value",

                e

            )

Create a requirements.txt file with the “Locust” package as the only entry.  Now install the package “pip install -r requirements.txt”.  Execute Locust – “locust”.  Navigate to the address provided – http://localhost:8089.  Run the test with 10 peak concurrent users with a 1 user started/second ramp.
A screenshot of a computerAI-generated content may be incorrect.

Review results:
A screenshot of a computerAI-generated content may be incorrect.

Update the expansion to a larger number and run again to determine the differences in performance.
Commit the code and tests to your GitHub repository.
Add a GitHub action and name it “capacitytest.yaml” with the following code:
name: Run Locust Load Test

 

on:

  push:

  pull_request:

 

jobs:

  load-test:

    runs-on: ubuntu-latest

 

    steps:

    - name: Checkout repository

      uses: actions/checkout@v4

 

    - name: Set up Python

      uses: actions/setup-python@v4

      with:

        python-version: "3.12"

 

    - name: Install requirements

      run: |

        python -m pip install --upgrade pip

        pip install locust

 

    - name: Run Locust Load Test

      run: |

        mkdir -p results

        locust -f locustfile.py \

          --headless \

          --users 10 \

          --spawn-rate 1 \

          --run-time 30s \

          --loglevel INFO \

          --csv results/locust_stats

 

    - name: Upload Locust Results

      uses: actions/upload-artifact@v4

      with:

        name: locust-results

        path: results
